rewritten code for the second model (w/ hosts and jumps), with classes implementation to increase performance and readibility
